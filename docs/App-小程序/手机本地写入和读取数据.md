// å¯¼å…¥æ–‡ä»¶ç³»ç»Ÿç®¡ç†å™¨
const system = wx.getFileSystemManager();

/**
 * åŒæ­¥å†™å…¥æ•°æ®åˆ°æŒ‡å®šçš„æ–‡ä»¶ä¸­
 * @param {string} fileName - æ–‡ä»¶åï¼Œä¸åŒ…æ‹¬æ‰©å±•å
 * @param {*} data - è¦å†™å…¥çš„æ•°æ®ï¼Œä»»æ„ç±»å‹
 */
function write(fileName, data) {
  try {
    system.writeFileSync(
      `${wx.env.USER_DATA_PATH}/${fileName}.json`,
      JSON.stringify(data),
      "utf8"
    );
    console.log('ğŸ“² ~ ', `${fileName}æœ¬åœ°ç¼“å­˜å†™å…¥æˆåŠŸ`);
    return true;
  } catch (e) {
    console.log('ğŸ“µ ~ ', `${fileName}æœ¬åœ°ç¼“å­˜å†™å…¥å¤±è´¥: ` + e);
    return false;
  }
}

/**
 * åŒæ­¥è¯»å–æŒ‡å®šæ–‡ä»¶çš„å†…å®¹
 * @param {string} fileName - æ–‡ä»¶åï¼Œä¸åŒ…æ‹¬æ‰©å±•å
 */
function read(fileName) {
  try {
    const json = system.readFileSync(
      `${wx.env.USER_DATA_PATH}/${fileName}.json`,
      "utf8"
    );
    console.log('ğŸ“² ~ ', `${fileName}æœ¬åœ°ç¼“å­˜è¯»å–æˆåŠŸ`);
    return JSON.parse(json);
  } catch (e) {
    console.log('ğŸ“µ ~ ', `${fileName}æœ¬åœ°ç¼“å­˜è¯»å–å¤±è´¥: ` + e);
    return [];
  }
}

const offLine = {
  write,
  read
};
export default offLine;
